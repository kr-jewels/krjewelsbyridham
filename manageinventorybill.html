<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex, nofollow">
  <title>Billing - KR by Ridham</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <script src="manageinventoryscript.js" defer></script>
</head>
<body class="bg-gray-900 text-white min-h-screen font-sans">
  <div class="container mx-auto p-4">
    <div class="text-center mb-6">
      <h1 class="text-3xl font-bold">Customer Bill</h1>
    </div>

    <div class="max-w-2xl mx-auto bg-gray-800 p-6 rounded-xl shadow-lg">
      <label class="block mb-2">Customer Name (optional)</label>
      <input id="customerName" type="text" class="w-full p-2 mb-4 rounded bg-gray-700 text-white" />

      <label class="block mb-2">Customer Contact (optional)</label>
      <input id="customerContact" type="text" class="w-full p-2 mb-4 rounded bg-gray-700 text-white" />

      <h2 class="text-xl font-semibold mb-4">Cart Items:</h2>
      <table class="w-full mb-4 text-sm bg-gray-700 rounded" id="cartTable">
        <thead>
          <tr class="bg-gray-600">
            <th class="p-2 text-left">Product Code</th>
            <th class="p-2 text-left">Price</th>
            <th class="p-2 text-left">Status</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <div class="flex justify-between text-lg mb-4">
        <p>Total Items: <span id="totalItems" class="font-bold text-green-400">0</span></p>
        <p>Total Price: <span id="totalPrice" class="font-bold text-yellow-400">â‚¹0.00</span></p>
      </div>

      <button onclick="handleSubmit()" class="w-full bg-blue-600 hover:bg-blue-700 py-2 rounded">Submit Bill</button>
    </div>
  </div>

  <script>
    const BACKEND_URL = "https://script.google.com/macros/s/AKfycbykh-8vOv1McWwRTkaJX8jPHUyB346epVNXSmtGSh8zHvAfkM5RKO5OpuC6I_grTZ5b/exec";

    window.onload = () => {
      displayCartTable("cartTable");
    };

    function handleSubmit() {
      const name = document.getElementById("customerName").value.trim();
      const contact = document.getElementById("customerContact").value.trim();

      console.log("Submitting payload:", {
        origin: window.location.origin,
        customerName: name,
        customerContact: contact,
        data: getCart()
      });

      submitBill(BACKEND_URL, name, contact);
    }
  </script>
</body>
</html>
